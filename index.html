<html>

<head>
    <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
    <script type="text/javascript">
        google.charts.load('current', { 'packages': ['corechart'] });
        google.charts.setOnLoadCallback(drawChart);

        async function drawChart() {

            const orefData = await fetch('data.json').then(x => x.json());

            var data = google.visualization.arrayToDataTable([
                ['DateTime', 'Count'],
                ...normalizeData(orefData)
            ]);

            var options = {
                title: 'Alerts count',
                curveType: 'function',
                legend: { position: 'bottom' },
                explorer: {
                    actions: ['dragToZoom', 'rightClickToReset'],
                    axis: 'horizontal',
                    keepInBounds: true,
                    maxZoomIn: 16.0
                }
            };

            var chart = new google.visualization.LineChart(document.getElementById('curve_chart'));

            chart.draw(data, options);
        }

        function normalizeData(data) {
            const normalized = data.reduce((prev, curr) => {
                prev[curr.datetime] = (prev[curr.datetime] || 0) + 1;
                return prev;
            }, {});

            return Object.entries(normalized)
                .map(([key, value]) => [new Date(key), value]);
        }

        /*
        
            [
                "עין השלושה",
                "נירים",
                "שוקדה",
                "כפר עזה",
                "סעד",
                "זמרת ושובה",
                "נחל עוז",
                "עלומים",
                "בארי",
                "דקל",
                "יבול",
                "שדה אברהם",
                "יתד",
                "אבשלום",
                "חולית",
                "סופה",
                "כרם שלום",
                "נתיב העשרה",
                "יד מרדכי",
                "ארז",
                "אשדוד - יא,יב,טו,יז,מרינה",
                "אשדוד - א,ב,ד,ה",
                "אשדוד - אזור תעשייה צפוני ונ",
                "אשקלון",
                "אזור תעשייה צפוני אשקלון",
                "באר גנים",
                "ניצנים",
                "ניצן",
                "זיקים",
                "אזור תעשייה הדרומי אשקלון",
                "חוות שיקמים",
                "נתיבות",
                "כפר מימון ותושיה",
                "תקומה",
                "יכיני",
                "גבים, מכללת ספיר",
                "זרועה",
                "שדרות, איבים",
                "מטווח ניר עם",
                "מפלסים",
                "ניר עם",
                "כיסופים",
                "בית עזרא",
                "אשדוד - ח,ט,י,יג,יד,טז",
                "אזור תעשייה עד הלום",
                "יושיביה",
                "ניר עוז",
                "כרמיה",
                "אשדוד - ג,ו,ז",
                "ניר ישראל",
                "שלומית",
                "צוחר ואוהד",
                "מבטחים עמיעוז ישע",
                "תלמי אליהו",
                "שדה ניצן",
                "ניר יצחק",
                "תקומה וחוות יזרעם",
                "בית שקמה",
                "מבקיעים",
                "גיאה",
                "בת הדר",
                "תלמי יפה",
                "גברעם",
                "משען",
                "נווה",
                "רהט והפזורה",
                "משמר הנגב",
                "תראבין א-צאנע ופזורה",
                "שתולים",
                "שדה עוזיהו",
                "גן יבנה",
                "ניר גלים",
                "כרם ביבנה",
                "כפר אביב",
                "מתחם בני דרום",
                "גן הדרום",
                "בני דרום",
                "קבוצת יבנה",
                "באר שבע - דרום",
                "באר שבע - צפון",
                "עומר",
                "באר שבע - מזרח",
                "ואדי אל נעם",
                "לקיה והפזורה",
                "באר שבע - מערב",
                "אזור תעשייה עידן הנגב",
                "להבים",
                "רנן",
                "פדויים",
                "תל שבע",
                "נבטים",
                "שגב שלום והפזורה",
                "אבו-תלול והפזורה",
                "קרית חינוך מרחבים",
                "מסלול",
                "פטיש",
                "אופקים",
                "גילת",
                "בטחה",
                "מולדה, אל-סייד והפזורה",
                "אום בטין והפזורה",
                "חצרים",
                "רעים",
                "פרי גן",
                "תפרח",
                "אשל הנשיא",
                "גבעות בר",
                "שובל",
                "צאלים",
                "ברוש",
                "תדהר",
                "תאשור",
                "בית הגדי",
                "הודיה",
                "אורות",
                "משואות יצחק",
                "באר טוביה",
                "קריית מלאכי",
                "נגבה",
                "כפר ורבורג",
                "כפר אחים",
                "מעגלים גבעולים מלילות",
                "תלמי ביל''ו",
                "אור הנר",
                "עין הבשור",
                "ברכיה",
                "כפר סילבר",
                "עזריקם",
                "עזר",
                "אמונים",
                "גבעתי",
                "עכו - אזור תעשייה",
                "כפר מסריק",
                "עין המפרץ",
                "עכו",
                "אזור תעשייה שער נעמן",
                "קריית מוצקין",
                "קריית ביאליק",
                "קריית ים",
                "אעבלין",
                "שפרעם",
                "זרחיה",
                "שפיר",
                "מרכז שפירא",
                "עין צורים",
                "אביגדור",
                "תימורים",
                "ערוגות",
                "אזור תעשייה תימורים",
                "אחווה",
                "ינון",
                "בניה",
                "משגב דב",
                "שדמה",
                "גבעת וושינגטון",
                "כפר מרדכי",
                "עשרת",
                "בן זכאי",
                "מעון צופיה",
                "כפר הנגיד",
                "גאליה",
                "בית גמליאל",
                "יבנה",
                "חצור",
                "רחובות",
                "מגן",
                "נס ציונה",
                "גן שלמה",
                "פלמחים",
                "נצר סרני",
                "גיבתון",
                "נווה מבטח",
                "כנות",
                "מישר",
                "ביצרון",
                "בית חלקיה",
                "יד בנימין",
                "מזכרת בתיה",
                "פדיה",
                "נצר חזני",
                "תלמי יוסף",
                "דימונה",
                "קצר-א-סיר והפזורה",
                "אבו קרינאת והפזורה",
                "זוהר",
                "ניר ח''ן",
                "שחר",
                "נהורה",
                "יד נתן",
                "רווחה",
                "קוממיות",
                "קריית גת, כרמי גת",
                "אורים",
                "חלץ",
                "משגב עם",
                "ברור חיל",
                "דורות",
                "שרשרת",
                "פעמי תש''ז",
                "קלחים",
                "שיבולים",
                "כפר הרי''ף וצומת ראם",
                "תלמי יחיאל",
                "גדרה",
                "אזור תעשייה כנות",
                "קדרון",
                "בית אלעזרי",
                "גן שורק",
                "פארק תעשיות פלמחים",
                "בית חנן",
                "נטעים",
                "גבעת שמואל",
                "מקווה ישראל",
                "משמר השבעה",
                "חולון",
                "תל אביב - מרכז העיר",
                "גבעתיים",
                "בני ברק",
                "רמת גן - מערב",
                "בת-ים",
                "תל אביב - עבר הירקון",
                "תל אביב - מזרח",
                "תל אביב - דרום העיר ויפו",
                "רמת גן - מזרח",
                "אזור",
                "קריית אונו",
                "עינת",
                "כפר חב''ד",
                "צפריה",
                "כפר קאסם",
                "שהם",
                "בית נחמיה",
                "נופך",
                "נחלים",
                "בית דגן",
                "גינתון",
                "נען",
                "תעשיון צריפין",
                "מגשימים",
                "כפר טרומן",
                "בית עריף",
                "כפר ביל''ו",
                "בארות יצחק",
                "קריית עקרון",
                "חדיד",
                "רינתיה",
                "בני עטרות",
                "מצליח",
                "ברקת",
                "סתריה",
                "עיינות",
                "כפר נוער בן שמן",
                "ראשון לציון - מערב",
                "מזור",
                "בן שמן",
                "נחשונים",
                "אזור תעשייה אפק ולב הארץ",
                "תעשיון חצב",
                "זיתן",
                "שערי תקווה",
                "מעלה שומרון",
                "באר יעקב",
                "רמלה",
                "ראש העין",
                "יגל",
                "ניר צבי",
                "לוד",
                "גבעת כ''ח",
                "אחיעזר",
                "קרני שומרון",
                "טירת יהודה",
                "אלעד",
                "ישרש",
                "גבעת ברנר",
                "גנות",
                "ראשון לציון - מזרח",
                "פתח תקווה",
                "גת רימון",
                "גני תקווה",
                "חולדה",
                "יסודות",
                "אור יהודה",
                "חמד",
                "יהוד-מונוסון",
                "סביון",
                "גני הדר",
                "פתחיה",
                "אלקנה",
                "עץ אפרים",
                "גני יוחנן",
                "אלפי מנשה",
                "יציץ",
                "רמות מאיר",
                "ענב",
                "אורנית",
                "כפר סירקין",
                "ארסוף",
                "הרצליה - פיתוח",
                "מעש",
                "מתחם פי גלילות",
                "ניר משה",
                "ניר עקיבא",
                "כוכב מיכאל",
                "שדה יואב",
                "גת",
                "שדה משה",
                "איתן",
                "עוזה",
                "פארק תעשייה ראם",
                "בני עי''ש",
                "רחלים",
                "כפר תפוח",
                "מגדלים",
                "עלי",
                "גבעת השלושה",
                "קלנסווה",
                "ניצני עוז",
                "טייבה",
                "שער אפרים",
                "הוד השרון",
                "אירוס",
                "גפן",
                "תירוש",
                "רמת השרון",
                "אזור תעשייה נשר - רמלה",
                "אחיסמך",
                "תלמים",
                "גני טל",
                "חצב",
                "חפץ חיים",
                "גבולות",
                "בני נצרים",
                "אבן שמואל",
                "שדה דוד",
                "בני ראם",
                "מודיעין",
                "כפר דניאל",
                "מבוא מודיעים",
                "גמזו",
                "מודיעין - ליגד סנטר"]
        */

    </script>
</head>

<body>
    <div id="curve_chart" style="width: 100%; height: 750px"></div>
</body>

</html>